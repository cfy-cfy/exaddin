<!DOCTYPE html>
<head>
    <title>Document</title>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>    
</head>
<body>
    <script type="text/javascript" src="./data/M1_VBAId.js"></script>
  
    <script>
      // var fromJava = "{\"total\" : 2,\"VBAIdCode\":[{\"No.\":1,\"Name\":\"ukVan\",\"SDate\":\"2022-03-10\",\"IdCode\":\"Van\"},{\"No.\":2,\"Name\":\"ukSynology\",\"SDate\":\"2022-02-17\",\"IdCode\":\"Nas\"}]}"

      // var fromJava='{"total" : 2,"VBAIdCode":[{"No.":1,"Name":"ukVan","SDate":"2022-03-10","IdCode":"Van"},{"No.":2,"Name":"ukSynology","SDate":"2022-02-17","IdCode":"Nas"}]}'
      
      var json = {
           "total":2,
           "VBAIdCode":[{"No.":1,"Name":"ukVan","SDate":"2022-03-10","IdCode":"Van"},   {"No.":2,"Name":"ukSynology","SDate":"2022-02-17","IdCode":"Nas"}]
         }  

        window.onload = function(){
            document.getElementById("dispalybtn").onclick = function(){
                // window.eval("var json = " + fromJava)
                document.getElementById("totalSpan").innerHTML = json.total;
                var vbaArray = json.VBAIdCode;
                var html = "";
                for(var i = 0; i < vbaArray.length; i++){
                    var s = vbaArray[i];
                    html +="<tr>";
                    html += "<td>" + (i + 1) + "</td>";
                    html += "<td>" + s.Name + "</td>";
                    html += "<td>" + s.SDate + "</td>";
                    html += "<td>" + s.IdCode + "</td>";                 
                    html += "</tr>";
                }
                document.getElementById("vbatbody").innerHTML = html;          
            }
        }
    </script>
    <input type="button" value="【VBAIdCode】" id="dispalybtn">
    <table border="1px" width="40%">
        <tr>
            <th>No.</th>          
            <th>Name</th>
            <th>SDate</th>
            <th>IdCode</th>
        </tr>
        <tbody id="vbatbody"></tbody>
    </table>
    总计条数：<span id="totalSpan"></span>
</body>
</html>