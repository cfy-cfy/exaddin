<!DOCTYPE html>
<head>
    <title>Document</title>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>    
</head>
<body>
    <script type="text/javascript" src="./data/M1_VBAId.js"></script>
    <script> 
      // var dic = {
      //    "total":2,
      //    "VBAIdCode":{"ukVan":{"No.":1,"IdCode":"Van","SDate":"2022-03-10","EDate":30},"ukSynology":{"No.":2,"IdCode":"Nas","SDate":"2022-03-17","EDate":30}}
      //  }  

      var xhr = new XMLHttpRequest();  
      xhr.open ("GET", "./data/M1_VBAId.json", false); 
      xhr.send();
      dic=JSON.parse(xhr.responseText);
      
        console.log(Object.keys(dic.VBAIdCode).length);
        for (var key in dic.VBAIdCode) {   
         console.log(key,dic.VBAIdCode[key]["IdCode"]);       
        }     
      
         window.onload = function(){
            document.getElementById("dispalybtn").onclick = function(){
                document.getElementById("totalSpan").innerHTML = dic.total;
                var html = "";
                var i=0;
                for (var key in dic.VBAIdCode) { 
                    html +="<tr>";
                    html += "<td>" + (i + 1) + "</td>";
                    html += "<td>" + key + "</td>";
                    html += "<td>" + dic.VBAIdCode[key]["IdCode"] + "</td>";                      
                    html += "<td>" + dic.VBAIdCode[key]["SDate"] + "</td>";    
                    html += "<td>" + dic.VBAIdCode[key]["EDate"] + "</td>";                     
                    html += "</tr>";
                    i++
                }
                document.getElementById("vbatbody").innerHTML = html;          
            }
        }
    </script>
    <input type="button" value="【VBAIdCode】" id="dispalybtn">
    <table border="1px" width="40%">
        <tr>
            <th>No.</th>          
            <th>Name</th>
            <th>IdCode</th>         
            <th>SDate</th>
            <th>EDate</th>
        </tr>
        <tbody id="vbatbody"></tbody>
    </table>
    总计条数：<span id="totalSpan"></span>
</body>
</html>